<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        
        <meta charset="UTF-8">
        <title>Working with Time Deltas | Analyzing Oztoc Data</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="briandk">
        <meta name="description" content="In this book we walk you through a short analysis of some actual play data collected from our game: Oztoc.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../data_analysis/visualizing_time_deltas.html" />
        
        
        <link rel="prev" href="../data_analysis/visualizing_events_over_time.html" />
        

        <meta property="og:title" content="Working with Time Deltas | Analyzing Oztoc Data">
        <meta property="og:site_name" content="Analyzing Oztoc Data">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/briandk">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    </head>
    <body>
        
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="briandk/makescape-adage-gitbook" data-level="2.6" data-basepath=".." data-revision="1401761736212">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/briandk/makescape-adage-gitbook" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/briandk/makescape-adage-gitbook/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/briandk/makescape-adage-gitbook/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >Analyzing Oztoc Data</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/briandk" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/briandk/makescape-adage-gitbook/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/briandk/makescape-adage-gitbook/edit/master/data_analysis/working_with_time_deltas.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="tools_we_use/README.html">
            
            <a href="../tools_we_use/README.html">
                <i class="fa fa-check"></i> <b>1.</b> The Tools We Use
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="data_analysis/README.html">
            
            <a href="../data_analysis/README.html">
                <i class="fa fa-check"></i> <b>2.</b> Data Analysis
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="data_analysis/article_1.html">
            
            <a href="../data_analysis/article_1.html">
                <i class="fa fa-check"></i> <b>2.1.</b> Loading and Cleaning the Data
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="data_analysis/inspecting_the_data_sanity_checks.html">
            
            <a href="../data_analysis/inspecting_the_data_sanity_checks.html">
                <i class="fa fa-check"></i> <b>2.2.</b> Inspecting the Data (Sanity Checks)
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="data_analysis/visualizing_the_data.html">
            
            <a href="../data_analysis/visualizing_the_data.html">
                <i class="fa fa-check"></i> <b>2.3.</b> Exploring Events by Type
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="data_analysis/why_are_there_so_many_makeconnectcomponent_events.html">
            
            <a href="../data_analysis/why_are_there_so_many_makeconnectcomponent_events.html">
                <i class="fa fa-check"></i> <b>2.4.</b> Why Are There So Many MakeConnectComponent Events?
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="data_analysis/visualizing_events_over_time.html">
            
            <a href="../data_analysis/visualizing_events_over_time.html">
                <i class="fa fa-check"></i> <b>2.5.</b> Visualizing Events Over Time
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="data_analysis/working_with_time_deltas.html">
            
            <a href="../data_analysis/working_with_time_deltas.html">
                <i class="fa fa-check"></i> <b>2.6.</b> Working with Time Deltas
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="data_analysis/visualizing_time_deltas.html">
            
            <a href="../data_analysis/visualizing_time_deltas.html">
                <i class="fa fa-check"></i> <b>2.7.</b> Visualizing Time Deltas
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 88.88888888888889%;min-width: 77.77777777777777%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../tools_we_use/README.html" title="The Tools We Use" class="chapter done new-chapter" data-progress="1" style="left: 11.11111111111111%;"></a>
    
        <a href="../data_analysis/README.html" title="Data Analysis" class="chapter done new-chapter" data-progress="2" style="left: 22.22222222222222%;"></a>
    
        <a href="../data_analysis/article_1.html" title="Loading and Cleaning the Data" class="chapter done " data-progress="2.1" style="left: 33.333333333333336%;"></a>
    
        <a href="../data_analysis/inspecting_the_data_sanity_checks.html" title="Inspecting the Data (Sanity Checks)" class="chapter done " data-progress="2.2" style="left: 44.44444444444444%;"></a>
    
        <a href="../data_analysis/visualizing_the_data.html" title="Exploring Events by Type" class="chapter done " data-progress="2.3" style="left: 55.55555555555556%;"></a>
    
        <a href="../data_analysis/why_are_there_so_many_makeconnectcomponent_events.html" title="Why Are There So Many MakeConnectComponent Events?" class="chapter done " data-progress="2.4" style="left: 66.66666666666667%;"></a>
    
        <a href="../data_analysis/visualizing_events_over_time.html" title="Visualizing Events Over Time" class="chapter done " data-progress="2.5" style="left: 77.77777777777777%;"></a>
    
        <a href="../data_analysis/working_with_time_deltas.html" title="Working with Time Deltas" class="chapter done " data-progress="2.6" style="left: 88.88888888888889%;"></a>
    
        <a href="../data_analysis/visualizing_time_deltas.html" title="Visualizing Time Deltas" class="chapter  " data-progress="2.7" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_9">
                    
                        <h1 id="working-with-time-deltas">Working with Time Deltas</h1>
<p>We&#39;re going to compute the time difference between successive events, which I&#39;m calling <em>time deltas</em>. It&#39;s worth taking a second to think about how the delta is defined:</p>
<p>For the $i$th event, the $\Delta$ value is given by the simple equation below, where $t_i$ is the timestamp of the $i$ th event: </p>
<object type="image/svg+xml" data="../assets/equation1.svg" height="100" width="200">Your browser does not support SVG</object>

<p>As a result, the very first event $(i = 0)$ in a series will have a diff value of <code>NaN</code> or <code>NaT</code> (Not a Time), because the -1st event is undefined. But the second event will have a diff value of (Time of Second event - Time of First event). The very last event will also have a value: (Time of Last event - Time of Penultimate event).</p>
<p>The handy thing about pandas is that every data series (and a column counts as data series) has a <code>diff()</code> method, which does exactly what we want: it computes successive pairwise differences between events. If we apply the <code>.diff()</code> function to our timestamps, we&#39;ll have exactly what we want: a column of numbers where each number represents the time elapsed since the event that came before.</p>
<pre><code class="lang-python">connectionEvents[<span class="hljs-string">'delta1'</span>] = connectionEvents.timestamp1.diff()
</code></pre>
<p>And, now that we have our column of deltas, how can we figure out where the big boring part starts? Well, the big boring part lasts a long time: multiple hours. So, what we&#39;re looking for is a huge time delta. Say a delta of more than five hours.</p>
<pre><code class="lang-python">connectionEvents[connectionEvents.delta1 &gt; np.timedelta64(<span class="hljs-number">5</span>, <span class="hljs-string">'h'</span>)][<span class="hljs-string">'timestamp'</span>]
</code></pre>
<pre><code>4443    1400077592798
Name: timestamp, dtype: int64
</code></pre><p>Bingo! Event 4443 marks the finale of the long boring stretch. Now we can create two subsets of data, which I&#39;ll call <code>day1</code> and <code>day2</code>, plot them separately, and cut out that big giant flatline from our original plot.</p>
<pre><code class="lang-python">whenBoringPartEnds = <span class="hljs-number">1400077592798</span>
day1 = connectionEvents[connectionEvents.timestamp &lt; whenBoringPartEnds]
day2 = connectionEvents[connectionEvents.timestamp &gt;= whenBoringPartEnds]

<span class="hljs-comment"># Creating the day1 plot</span>
p = ggplot(aes(x=<span class="hljs-string">'timestamp1'</span>,
               y=<span class="hljs-string">'cumulativeCount'</span>),
           data=day1)
p = p + geom_line()
p = p + ggtitle(<span class="hljs-string">'Cumulative Distribution of MakeConnectComponent Events'</span>)
p = p + xlab(<span class="hljs-string">'Time'</span>)
p = p + ylab(<span class="hljs-string">'Event Count'</span>)

<span class="hljs-comment"># Showing the plot</span>
print(p)

<span class="hljs-comment"># Saving the plot</span>
ggsave(plot=p,
       filename=<span class="hljs-string">'cumulativeDistributionDay1.png'</span>)

<span class="hljs-comment"># Creating the day2 plot</span>
p = ggplot(aes(x=<span class="hljs-string">'timestamp1'</span>,
               y=<span class="hljs-string">'cumulativeCount'</span>),
           data=day2)
p = p + geom_line()
p = p + ggtitle(<span class="hljs-string">'Cumulative Distribution of MakeConnectComponent Events'</span>)
p = p + xlab(<span class="hljs-string">'Time'</span>)
p = p + ylab(<span class="hljs-string">'Event Count'</span>)

<span class="hljs-comment"># Showing the plot</span>
print(p)

<span class="hljs-comment"># Saving the plot</span>
ggsave(plot=p,
       filename=<span class="hljs-string">'cumulativeDistributionDay2.png'</span>)
</code></pre>
<p><img src="../assets/cumulativeDistributionDay1.png" alt="Distribution of events from day 1"></p>
<p><img src="../assets/cumulativeDistributionDay2.png" alt="Distribution of events from day 2"></p>
<p>OK, this is helpful. We can definitely see that even after we cut out the boring parts, the slope of this cumulative distribution varies pretty wildly over time: there are really steep parts and really shallow parts.</p>
<p>But now my question is: how do we understand that change in slope? It stands to reason that in regions of shallow slope, there are probably very few events happening overall. But what about the steep parts? How can we understand what&#39;s causing such sharp increases in the graph?</p>
<p>The most pertinent question for us—as game designers right now—is: <strong>are those steep-sloped regions caused by kids actually connecting blocks, or by something else?</strong></p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../data_analysis/visualizing_events_over_time.html" class="navigation navigation-prev " aria-label="Previous page: Visualizing Events Over Time"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../data_analysis/visualizing_time_deltas.html" class="navigation navigation-next " aria-label="Next page: Visualizing Time Deltas"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
