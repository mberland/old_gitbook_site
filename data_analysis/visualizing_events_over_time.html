<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        
        <meta charset="UTF-8">
        <title>Visualizing Events Over Time | Analyzing Oztoc Data</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="briandk">
        <meta name="description" content="In this book we walk you through a short analysis of some actual play data collected from our game: Oztoc.">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../data_analysis/working_with_time_deltas.html" />
        
        
        <link rel="prev" href="../data_analysis/why_are_there_so_many_makeconnectcomponent_events.html" />
        

        <meta property="og:title" content="Visualizing Events Over Time | Analyzing Oztoc Data">
        <meta property="og:site_name" content="Analyzing Oztoc Data">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/briandk">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    </head>
    <body>
        
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="briandk/makescape-adage-gitbook" data-level="2.5" data-basepath=".." data-revision="1401761310633">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="https://github.com/briandk/makescape-adage-gitbook" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/briandk/makescape-adage-gitbook/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/briandk/makescape-adage-gitbook/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >Analyzing Oztoc Data</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        <li>
            <a href="https://github.com/briandk" target="blank" class="author-link">About the author</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/briandk/makescape-adage-gitbook/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        
        <li>
            <a href="https://github.com/briandk/makescape-adage-gitbook/edit/master/data_analysis/visualizing_events_over_time.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        
        <li class="divider"></li>
        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="tools_we_use/README.html">
            
            <a href="../tools_we_use/README.html">
                <i class="fa fa-check"></i> <b>1.</b> The Tools We Use
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="data_analysis/README.html">
            
            <a href="../data_analysis/README.html">
                <i class="fa fa-check"></i> <b>2.</b> Data Analysis
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="data_analysis/article_1.html">
            
            <a href="../data_analysis/article_1.html">
                <i class="fa fa-check"></i> <b>2.1.</b> Loading and Cleaning the Data
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="data_analysis/inspecting_the_data_sanity_checks.html">
            
            <a href="../data_analysis/inspecting_the_data_sanity_checks.html">
                <i class="fa fa-check"></i> <b>2.2.</b> Inspecting the Data (Sanity Checks)
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="data_analysis/visualizing_the_data.html">
            
            <a href="../data_analysis/visualizing_the_data.html">
                <i class="fa fa-check"></i> <b>2.3.</b> Exploring Events by Type
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="data_analysis/why_are_there_so_many_makeconnectcomponent_events.html">
            
            <a href="../data_analysis/why_are_there_so_many_makeconnectcomponent_events.html">
                <i class="fa fa-check"></i> <b>2.4.</b> Why Are There So Many MakeConnectComponent Events?
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="data_analysis/visualizing_events_over_time.html">
            
            <a href="../data_analysis/visualizing_events_over_time.html">
                <i class="fa fa-check"></i> <b>2.5.</b> Visualizing Events Over Time
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="data_analysis/working_with_time_deltas.html">
            
            <a href="../data_analysis/working_with_time_deltas.html">
                <i class="fa fa-check"></i> <b>2.6.</b> Working with Time Deltas
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="data_analysis/visualizing_time_deltas.html">
            
            <a href="../data_analysis/visualizing_time_deltas.html">
                <i class="fa fa-check"></i> <b>2.7.</b> Visualizing Time Deltas
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 77.77777777777777%;min-width: 66.66666666666667%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../tools_we_use/README.html" title="The Tools We Use" class="chapter done new-chapter" data-progress="1" style="left: 11.11111111111111%;"></a>
    
        <a href="../data_analysis/README.html" title="Data Analysis" class="chapter done new-chapter" data-progress="2" style="left: 22.22222222222222%;"></a>
    
        <a href="../data_analysis/article_1.html" title="Loading and Cleaning the Data" class="chapter done " data-progress="2.1" style="left: 33.333333333333336%;"></a>
    
        <a href="../data_analysis/inspecting_the_data_sanity_checks.html" title="Inspecting the Data (Sanity Checks)" class="chapter done " data-progress="2.2" style="left: 44.44444444444444%;"></a>
    
        <a href="../data_analysis/visualizing_the_data.html" title="Exploring Events by Type" class="chapter done " data-progress="2.3" style="left: 55.55555555555556%;"></a>
    
        <a href="../data_analysis/why_are_there_so_many_makeconnectcomponent_events.html" title="Why Are There So Many MakeConnectComponent Events?" class="chapter done " data-progress="2.4" style="left: 66.66666666666667%;"></a>
    
        <a href="../data_analysis/visualizing_events_over_time.html" title="Visualizing Events Over Time" class="chapter done " data-progress="2.5" style="left: 77.77777777777777%;"></a>
    
        <a href="../data_analysis/working_with_time_deltas.html" title="Working with Time Deltas" class="chapter  " data-progress="2.6" style="left: 88.88888888888889%;"></a>
    
        <a href="../data_analysis/visualizing_time_deltas.html" title="Visualizing Time Deltas" class="chapter  " data-progress="2.7" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_5">
                    
                        <h1 id="visualizing-events-over-time">Visualizing Events Over Time</h1>
<p>So, it seems like we have way too many <code>MakeConnectComponent</code> events. Earlier, I explained that we&#39;re <em>averaging</em> more than one <code>MakeConnectComponent</code> event per second. But what if we wanted to think about whether that average really describes a typical time slice of our data? In other words, we might want to know how our <code>MakeConnectcomponent</code> events are distributed over time.</p>
<p>One way to think about that distribution is to ask: <em>when do our <code>MakeConnectComponent</code> events occur over time?</em> Below, I&#39;m going to use the <code>ggplot</code> package to look at the cumulative distribution of the connection events. The syntax may seem wonky and complicated at first, but it&#39;s actually an elegant implementation of <a href="http://docs.ggplot2.org/0.9.3.1/index.html" target="_blank">ggplot2</a>, itself an implementation of Leland Wilkinson&#39;s <a href="http://www.amazon.com/Grammar-Graphics-Statistics-Computing-ebook/dp/B003XQF3TQ/ref=sr_1_1?ie=UTF8&amp;qid=1401707640&amp;sr=8-1&amp;keywords=grammar+of+graphics" target="_blank">Grammar of Graphics</a>. If at first you&#39;re stymied by it, don&#39;t worry. I&#39;ll try to help break it down for you.</p>
<p>First, we&#39;re doing some basic manipulation to get a cumulative sum column. This is actually so dumb I&#39;m almost embarrased. I create a column by applying a <a href="http://www.diveintopython.net/power_of_introspection/lambda_functions.html" target="_blank">lambda function</a> to the <code>timestamp</code> column that <em>always</em> returns 1, then I just sum cumulatively over that column. Lastly, I apply another <a href="http://www.diveintopython.net/power_of_introspection/lambda_functions.html" target="_blank">lambda function</a> to format our timestamp (currently an integer) into a nicer-formatted timestamp.</p>
<p>I&#39;ll break these plotting lines down one major line at a time:</p>
<ol>
<li>I create a <code>ggplot</code> object, which is essentially the basic kind of object from whence all plots are constructed in ggplot. <code>aes()</code> just stands for <em>aes</em>thetic mapping, where I&#39;m telling ggplot how to map data to graphical features. In this case, I&#39;m saying &quot;map the values in the <code>timestamp1</code> column to the x position of this plot, and map the values of <code>cumulativeCount</code> to the y position. It may seem trivial now, but the power of aesthetic mappings like this is that I can also map quantities (or categories) to other graphical properties, for example mapping other columns in my dataframe to the aesthetic properties of color or shape. For now, we&#39;ll just stick with mapping quantities to cartesian x and y coordinates. When creating the <code>ggplot</code> object, I also tell it what dataframe I&#39;m talking about, so the local names of <code>timestamp1</code> and <code>cumulativeCount</code> make sense in scope.</li>
<li>What we see now is a common pattern in ggplot-style programming. I can literally <em>add</em> a layer to my plot using the plus operator. Here, I&#39;m telling ggplot that I want it to apply my chosen aesthetic mappings using a line geometry, which means it will connect each discrete datapoint with a line. (An alternative geometry would have been a simple <em>point</em> geometry, <code>geom_point()</code>, which would give us a bivariate scatterplot instead of a lineplot.</li>
<li>The remaining lines add special options to my plot using the same compositional syntax of the plus operator. Here, I&#39;m using special functions <code>ggtitle()</code>, <code>xlab()</code>, and <code>ylab()</code> to set the text for the plot title and axis labels.</li>
<li>Next I just use a simple <code>print()</code> call to make sure my plot shows up in my interactive session.</li>
<li>Finally, I use a convenience function called <code>ggsave()</code> to save my plot directly to a file. <code>ggsave()</code> is smart and it detects the desired type of output file based on the suffix you pass in as a filename. In this case I&#39;m using the .PNG format for images, but if I wanted an infinitely scalable image I could have used a .PDF extension.</li>
</ol>
<pre><code class="lang-python"><span class="hljs-comment"># Manipulating the data to get a cumulative sum</span>
<span class="hljs-comment"># and nicely formatted timestamps</span>
connectionEvents = ms[ms.key == <span class="hljs-string">'MakeConnectComponent'</span>]
connectionEvents[<span class="hljs-string">'cumulativeCount'</span>] = connectionEvents.timestamp.apply(<span class="hljs-keyword">lambda</span> x: <span class="hljs-number">1</span>).cumsum()
connectionEvents[<span class="hljs-string">'timestamp1'</span>] = connectionEvents.timestamp.apply(<span class="hljs-keyword">lambda</span> x: pd.Timestamp(x, unit=<span class="hljs-string">'ms'</span>))

<span class="hljs-comment"># Creating the basic plot</span>
p = ggplot(aes(x=<span class="hljs-string">'timestamp1'</span>,
               y=<span class="hljs-string">'cumulativeCount'</span>),
           data=connectionEvents)
p = p + geom_line()
p = p + ggtitle(<span class="hljs-string">'Cumulative Distribution of MakeConnectComponent Events'</span>)
p = p + xlab(<span class="hljs-string">'Time'</span>)
p = p + ylab(<span class="hljs-string">'Event Count'</span>)

<span class="hljs-comment"># Showing the plot</span>
print(p)

<span class="hljs-comment"># Saving the plot</span>
ggsave(plot=p,
       filename=<span class="hljs-string">'cumulativeDistributionOfMakeConnectComponent1.png'</span>)
</code></pre>
<p><img src="../assets/cumulativeDistributionOfMakeConnectComponent1.png" alt="Cumulative Distribution of MakeComponentConnect Events"></p>
<p>This plot has a number of interesting features. Easily the most salient feature is the giant flat-line in the center. It looks like there were effectively no <code>MakeConnectComponent</code> events between between 2000 hrs on the first day and 1400 hrs on the second day. And that seems entirely reasonable: the game likely would have been shut off during the night, then fired up again for testing the next day.</p>
<p>The challenge is that on either side of the flatline the curves are quite steep. That means there could be a fair amount of information hiding in the areas of the plot where there was activity, but it&#39;s up to us to extract out that long, boring middle portion where nothing is happening. How can we do that?</p>
<p>Well, suppose what we wanted was to create two new plots, call them Day 1 and Day 2, that have just the interesting parts: the parts where the slope of the cumulative distribution is nonzero. (Note that when the slope is nonzero, that&#39;s when action is happening and we&#39;re registering events over time.) If we wanted two separate plots, all we have to is figure out when, exactly, that boring stretch of time starts and when, exactly, it ends. And, one way to do that would be if we could somehow generate the time that elapses between each successive event in our dataset. So, let&#39;s do it!</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../data_analysis/why_are_there_so_many_makeconnectcomponent_events.html" class="navigation navigation-prev " aria-label="Previous page: Why Are There So Many MakeConnectComponent Events?"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../data_analysis/working_with_time_deltas.html" class="navigation navigation-next " aria-label="Next page: Working with Time Deltas"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
